function LoadMenus(){mLoadMenuCount++;AddProgress(mProgress);mLoadMenuCount==3&&((mCurrentMode==2||mCurrentMode==3)&&oReadRequestRepeat.addParameter(1,55,0,function(n){mLinearSpeedActive=n.currentValue}),oReadRequestRepeat.addParameter(11,84,0,function(n){mCurrentMode=n.currentValue}),$("#optionSlot0").val(mProductFamily+"."+mProductModel).attr("disabled",!1),$("#selectSlot").val(mProductFamily+"."+mProductModel),ctdatabase.getPath(mProductFamily+"."+mProductModel),ctdatabase.populateMenuDropDown(mCurrentMode,query.menu),$("#selectMenu, #selectParameter").attr("disabled",!1),refreshValue($("#selectMenu").val(),$("#selectParameter").val()))}function refreshValue(n,t,i){var u,f,r;for(clearTimeout(oRequestQueue.stateCheckTimeout),u=0;u<oRequestQueue.requestList.length;u++)oRequestQueue.requestList[u].requestCode==19&&oRequestQueue.requestList.splice(u,1);oReadRequestRepeat.parameterList.length=0;f=new classRequestObjectInfo;mFirstDisplay=!0;mReadParameter=null;r=document.getElementById("selectSlot").selectedIndex;r===undefined&&(r=0);$("#currentValue").text(getTT("Getting value...","tt_52"));(mCurrentMode==2||mCurrentMode==3)&&oReadRequestRepeat.addParameter(1,55,0,function(n){mLinearSpeedActive=n.currentValue});n<0&&(r=parseInt($('#selectMenu option[value="'+n+'"]').attr("data-slot")),n=0);f.addParameter(n,t,r,function(u){isCurrentParameter(u.menuId,u.parameterId)&&(mReadParameter=u,oReadRequestRepeat.addParameter(n,t,r,function(n){mReadParameter!=null&&isCurrentParameter(n.menuId,n.parameterId)&&(mReadParameter.currentValue=n.currentValue,mReadParameter.decimalPlaces=n.decimalPlaces,mReadParameter.dataType=n.dataType,mReadParameter.unitText=n.unitText,mReadParameter.accessStatus=n.accessStatus,currentParameter=displayValue(mReadParameter,i));i=0}),oReadRequestRepeat.wakeUp(),oRequestQueue.stateCheck("ObjectInfo Returned"))},!0);oRequestQueue.addRequest(f);oRequestQueue.stateCheck("refreshValue")}function getQuery(){return{}}function setFormatTextBox(n){var t;if(isMnemonic)t="select";else if(n.dataType==0)t="checkbox",n.currentValue==1?($("#writeValueCheck").prop("checked",!0),$("#writeValueUnits").val(getTT("On","tt_62"))):($("#writeValueCheck").prop("checked",!1),$("#writeValueUnits").val(getTT("Off","tt_61")));else{$("#writeValueUnits").val(n.unitText);switch(n.formatId){case 1:case 2:case 8:t="textboxes";break;case 0:default:t="textbox"}}switch(t){default:case"select":$("#writeCheckboxContainer, #writeValue1, #writeValue2, #writeValue3, #writeValueUnits").hide();$("#writeSelect").show();break;case"textbox":$("#writeCheckboxContainer, #writeSelect").hide();$("#writeValue1").removeClass("write3").addClass("write1").show();$("#writeValueUnits").show();$("#writeValue2, #writeValue3").hide();break;case"textboxes":$("#writeCheckboxContainer, #writeSelect").hide();$("#writeValue1").removeClass("write1").addClass("write3").show();$("#writeValue2, #writeValue3, #writeValueUnits").show();break;case"checkbox":$("#writeValue1, #writeValue2, #writeValue3, #writeSelect").hide();$("#writeCheckboxContainer, #writeValueUnits").show()}}function clearFields(){$("#writeValue1, #writeValue2, #writeValue3").val("")}function clearWarnings(){$("#warningBar, #savedMessage").hide()}function isCurrentParameter(n,t){return n==$("#selectMenu").val()&&t==$("#selectParameter").val()||parseInt($("#selectMenu").val())<0&&n==0&&t==$("#selectParameter").val()?!0:!1}function displayValue(n,t){if(isCurrentParameter(n.menuId,n.parameterId)){AddProgress(mProgress);var i=ctdatabase.getMnemonic(n,mFirstDisplay);if(i==null?(isMnemonic=!1,i=ctdatabase.setFormatValue(n)):isMnemonic=!0,n.unitText=ctdatabase.setModeDependentUnits(mCurrentMode,mLinearSpeedActive,n.unitText),mFirstDisplay){if(n.writable?(setFormatTextBox(n),$("#writeReadOnly").hide(),$("#writeForm").show()):($("#writeForm").hide(),$("#writeReadOnly").show()),t==1||isMnemonic)switch(n.formatId){case 1:case 2:$("#writeValue1").val(i.substr(0,2));$("#writeValue2").val(i.substr(3,2));$("#writeValue3").val(i.substr(6,2));break;case 8:$("#writeValue1").val(i.substr(0,1));$("#writeValue2").val(i.substr(2,2));$("#writeValue3").val(i.substr(5,3));break;default:$("#writeValue1").val(i)}mFirstDisplay=!1}return n.unitText!=""&&(i=i+" "+n.unitText),$("#currentValue").text(i),n}}function resetDrive(){$("#resetButton").val(getTT("Resetting...","tt_76"));var n=new classRequestWrite,t=new classWriteParameter(10,38,0,100,2,0);n.successCallBack=function(n){n.accessStatus!=0&&alert(getTT("Action was unsuccessful.","tt_94"));$("#resetButton").val(getTT("Reset Drive","tt_69"))};n.parameterList.push(t);oRequestQueue.addRequest(n);oRequestQueue.stateCheck()}function saveAll(n){$("#saveButton").val(getTT("Saving...","tt_75"));var t=new classRequestWrite,i=new classWriteParameter(0,0,0,n,4,0);t.successCallBack=function(n){n.accessStatus!=0?alert(getTT("Action was unsuccessful.","tt_94")):resetDrive();$("#saveButton").val(getTT("Saved","tt_74")).delay(2e3).val(getTT("Save All","tt_73"))};t.parameterList.push(i);oRequestQueue.addRequest(t);oRequestQueue.stateCheck()}function writeValue(){var t,f,e,n,r,i,u,o;mFirstDisplay=!0;$("#newValueButton").val(getTT("Submitting","tt_77"));$("#warningBar").hide().text(ctdatabase.getErrorMessage(9));t=$("#writeValue1").val();isMnemonic&&(t=parseInt($("#writeSelect").val()));f=$("#writeValue2").val();e=$("#writeValue3").val();currentParameter!==undefined&&(n=currentParameter,t===""&&n.dataType!=0?$("#warningBar").text(getTT("Error, please enter a value.","tt_27")).show():(r=0,i=10,n.dataType==0?n.currentValue=writeForm.writeValueCheck.checked==!0?1:0:i=ctdatabase.isValidInput(n,t,f,e),i==10&&n.formatId==0&&n.dataType>0&&n.dataType<22&&(t<n.min/Math.pow(10,n.decimalPlaces)||t>n.max/Math.pow(10,n.decimalPlaces))&&(i=246,r=n.decimalPlaces),i==10?(n.dataType!=0&&(n=ctdatabase.setWriteFormat(n,t,f,e)),u=new classRequestWrite,o=new classWriteParameter(n.menuId,n.parameterId,n.slotId,n.currentValue,n.dataType,n.decimalPlaces),u.successCallBack=function(t){accessStatus=t.accessStatus;accessStatus!=0?$("#warningBar").text(ctdatabase.getErrorMessage(accessStatus,n,r)).show():(refreshValue($("#selectMenu").val(),$("#selectParameter").val(),1),clearWarnings());$("#newValueButton").val(getTT("Submit","tt_85"))},u.parameterList.push(o),oRequestQueue.addRequest(u),oRequestQueue.stateCheck()):($("#warningBar").text(ctdatabase.getErrorMessage(i,currentParameter,r,currentParameter.dataType)).show(),$("#newValueButton").val(getTT("Submit","tt_85")))))}var query=getQuery(),currentParameter,mLoadMenuCount=0,mCurrentMode=-1,mLinearSpeedActive=-1,isMnemonic=!1,mProgress={count:0,total:4},mReadParameter=null,mFirstDisplay=!0,delayStateCheck=!0,oReadRequest=new classRequestReadWithType,oReadRequestRepeat=new classRequestReadWithType;oReadRequestRepeat.isMonitorRequest=!0;oReadRequest.addParameter(11,84,0,function(n){mCurrentMode=n.currentValue;LoadMenus()});ctdatabase.loadData(function(){LoadMenus();oRequestQueue.stateCheck()});oReadRequest.addParameter(15,1,0,function(n){n.currentValue==0?$("#optionSlot1").text("1 - "+getTT("Not Fitted","tt_59")):$("#optionSlot1").text("1 - "+ctdatabase.getDeviceName(n.currentValue)).val(n.currentValue).prop("disabled",!1)});oReadRequest.addParameter(16,1,0,function(n){n.currentValue==0?$("#optionSlot2").text("2 - "+getTT("Not Fitted","tt_59")):$("#optionSlot2").text("2 - "+ctdatabase.getDeviceName(n.currentValue)).val(n.currentValue).prop("disabled",!1)});oReadRequest.addParameter(17,1,0,function(n){n.currentValue==0?$("#optionSlot3").text("3 - "+getTT("Not Fitted","tt_59")):$("#optionSlot3").text("3 - "+ctdatabase.getDeviceName(n.currentValue)).val(n.currentValue).prop("disabled",!1)});oReadRequest.addParameter(24,1,0,function(n){n.currentValue==0?$("#optionSlot4").text("4 - "+getTT("Not Fitted","tt_59")):$("#optionSlot4").text("4 - "+ctdatabase.getDeviceName(n.currentValue)).val(n.currentValue).prop("disabled",!1)});oRequestQueue.addRequest(oReadRequest);oRequestQueue.addRequest(oReadRequestRepeat);$("#selectParameter").change(function(){refreshValue($("#selectMenu").val(),$("#selectParameter").val(),1);clearFields();clearWarnings()});$("#selectMenu").change(function(){mCurrentMenuIndex=ctdatabase.populateParameterDropDown(mCurrentMode,$("#selectMenu").val(),$("#selectParameter").val());refreshValue($("#selectMenu").val(),$("#selectParameter").val(),1);clearFields();clearWarnings()});$("#selectSlot").change(function(){ctdatabase.getPath($("#selectSlot").val());ctdatabase.populateMenuDropDown(mCurrentMode,query.menu);refreshValue($("#selectMenu").val(),$("#selectParameter").val(),1);clearFields();clearWarnings()});$("#writeValueCheck").change(function(){$(this).prop("checked")==!0?$("#writeValueUnits").val(getTT("On","tt_62")):$("#writeValueUnits").val(getTT("Off","tt_61"))});$("#saveButton").click(function(){$(this).val(getTT("Saving...","tt_75"));saveAll(1001)});