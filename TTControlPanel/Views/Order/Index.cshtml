@model IndexOrderGetModel
@{
    ViewData["Title"] = "Commesse";
}
<div id="explorerLink">
    Commesse
</div>
<h2>Commesse</h2>
<br />
<div style="text-align:right; margin: 0px 0px 30px 0px;">
    <a asp-action="New" asp-controller="Order"><input type="button" value="Nuovo" /></a>
    <form style="float:left;">
        <label style="width: 55px; display: inline-block; text-align:left;">Ordina:</label>
        <select id="orderby" name="orderby" style="margin: 0px !important; width:200px;">
            <option asp-selected="@(Model.OrderBy == "id")" value="id">Primo inserito</option>
            <option asp-selected="@(Model.OrderBy == "-id")" value="-id">Ultimo inserito</option>
            <option asp-selected="@(Model.OrderBy == "number")" value="number">Codice</option>
            <option asp-selected="@(Model.OrderBy == "name")" value="name">Nome</option>
            <option asp-selected="@(Model.OrderBy == "enddate")" value="name">Data Fine</option>
        </select>
    </form>
</div>
<table class="table">
    <tr style="font-weight:bold;">
        <td style="width:90px;">Numero</td>
        <td style="width:150px;">Nome</td>
        <td style="width:150px;">Cliente</td>
        <td style="width:200px;">Descrizione</td>
        <td style="width:90px;">Data Consegna</td>
        <td style="width:70px;">Fattura</td>
        <td style="width:70px;">In lavoro</td>
        <td>Azioni</td>
    </tr>
    @foreach (var o in Model.Orders)
    {
        var work = Model.Workings.Where(w => w.Order.Id == o.Id).FirstOrDefault();
        var aw = 0;
        if (work != null && work.AtProgress)
        {
            aw = 1;
        }
        <tr>
            <td style="font-weight:bold;"><a asp-controller="Order" asp-action="Details" asp-route-id="@o.Id">@o.Number</a></td>
            <td>@o.Name</td>
            <td>@o.Client.Name</td>
            <td>@o.Description</td>
            <td></td>
            <td></td>
            <td style="text-align:center;"><span style="vertical-align: middle;" class="led @(aw == 0 ? "red" : "green")"></span></td>
            <td>
                <span><a asp-controller="Working" asp-action="Details" asp-route-id="">Lavorazione</a></span>
                <span><a asp-controller="Order" asp-action="Edit" asp-route-id="@o.Id">Modifica</a></span>
                <span><a asp-controller="Order" asp-action="Delete" asp-route-id="@o.Id">Rimuovi</a></span>
            </td>
        </tr>
    }
    <tr asp-if="Model.Orders.Count == 0">
        <td colspan="7" style="text-align:center">Nessun prodotto presente</td>
    </tr>
</table>